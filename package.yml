name       : ypkg
homepage   : https://github.com/solus-project/ypkg
version    : '23'
release    : 91
source     :
    - https://github.com/solus-project/ypkg/releases/download/v22/ypkg-22.tar.gz : 6385238e8af8f0a1093a4143b9db0973e189daa27a72623ad79c27781cb5ae35
license    :
    - GPL-3.0
summary    : Modern, declarative, structured build format
component  : system.devel
builddeps  :
    - python-setuptools
rundeps    :
    - python-configobj
    - pyyaml
    - fakeroot
    - ruamel_yaml
description: |
    ypkg is the build tool of choice for Solus. Simply put, it is a tool to
    convert a build process into a packaging operation.
setup      : |
    %patch -p1 < $pkgfiles/0001-rc-Prevent-cross-contamination-of-py2-py3-build-cach.patch
    %patch -p1 < $pkgfiles/0002-spec-Ignore-duplication-when-key-isn-t-the-same-as-t.patch
    %patch -p1 < $pkgfiles/0003-Add-support-for-Clang-as-a-primary-compiler.patch
    %patch -p1 < $pkgfiles/0004-examine-Ensure-we-account-for-private-dependencies-i.patch
    %patch -p1 < $pkgfiles/0005-examine-Minor-corrections-to-prior-commit-to-make-it.patch
    %patch -p1 < $pkgfiles/0006-dependencies-Forbid-circular-pkgconfig-dependencies.patch
    %patch -p1 < $pkgfiles/0007-context-Enable-atomic-updates-for-PGO-generation.patch
    %python_setup
install    : |
    %python_install
    # These are going to be replaced by ypkg-tools
    install -D -m 00755 scripts/yupdate.py $installdir/usr/share/ypkg/yupdate.py
    install -m 00755 scripts/ybump.py $installdir/usr/share/ypkg/.
    # Stop eopkg check freaking out
    find $installdir -name "*.pyc" |xargs rm -v
