From ee257d5ff7bcc4a04dd81013f4ef254117096367 Mon Sep 17 00:00:00 2001
From: Ikey Doherty <ikey@solus-project.com>
Date: Sun, 10 Apr 2016 10:15:44 +0100
Subject: [PATCH 7/9] If its not obvious I hate emul32 at this point, it should
 be.

Signed-off-by: Ikey Doherty <ikey@solus-project.com>
---
 ypkg2/main.py     | 2 ++
 ypkg2/metadata.py | 2 +-
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/ypkg2/main.py b/ypkg2/main.py
index a2410a2..f34effc 100644
--- a/ypkg2/main.py
+++ b/ypkg2/main.py
@@ -108,6 +108,8 @@ def clean_build_dirs(context):
 
 def execute_step(context, step, step_n, work_dir):
     script = ScriptGenerator(context, context.spec, work_dir)
+    if context.emul32:
+        script.define_export("EMUL32BUILD", "1")
 
     exports = script.emit_exports()
 
diff --git a/ypkg2/metadata.py b/ypkg2/metadata.py
index 6926778..3355464 100644
--- a/ypkg2/metadata.py
+++ b/ypkg2/metadata.py
@@ -285,7 +285,7 @@ def handle_dependencies(context, gene, metadata, package, files):
     # Ensure some sane defaults are in place
     if package.name == "32bit" and "main" in gene.packages:
         dependencies.add(context.spec.get_package_name("main"))
-    elif package.name == "32-bit-devel":
+    elif package.name == "32bit-devel":
         if "32bit" in gene.packages:
             dependencies.add(context.spec.get_package_name("32bit"))
         if "main" in gene.packages:
-- 
2.8.1

