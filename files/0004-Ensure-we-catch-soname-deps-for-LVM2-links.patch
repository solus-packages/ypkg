From 30908abf20a867701073423030f56a44e7741963 Mon Sep 17 00:00:00 2001
From: Ikey Doherty <ikey@solus-project.com>
Date: Sat, 4 Jun 2016 08:03:14 +0100
Subject: [PATCH 4/5] Ensure we catch soname deps for LVM2 links

Signed-off-by: Ikey Doherty <ikey@solus-project.com>
---
 ypkg2/dependencies.py | 2 +-
 ypkg2/packages.py     | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/ypkg2/dependencies.py b/ypkg2/dependencies.py
index 77f1eac..6f59e7a 100644
--- a/ypkg2/dependencies.py
+++ b/ypkg2/dependencies.py
@@ -228,7 +228,7 @@ class DependencyResolver:
         for link in info.soname_links:
             fi = self.gene.get_file_owner(link)
             if not fi:
-                console_ui.emit_warning("SOLINK", "{} depends on non existing"
+                console_ui.emit_warning("SOLINK", "{} depends on non existing "
                                         "soname link: {}".
                                         format(packageName, link))
                 continue
diff --git a/ypkg2/packages.py b/ypkg2/packages.py
index 9b8f00a..c426f5d 100644
--- a/ypkg2/packages.py
+++ b/ypkg2/packages.py
@@ -258,8 +258,11 @@ class PackageGenerator:
 
     def get_file_owner(self, file):
         """ Return the owning package for the specified file """
+        rname = os.path.realpath(file)
         for pkg in self.packages:
             package = self.packages[pkg]
             if file in package.files:
                 return package
+            elif rname in package.files:
+                return package
         return None
-- 
2.8.3

